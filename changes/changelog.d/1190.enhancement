Improved shuffle behaviour (#1190)